ns enum_construction;

deftype State = either On(empty), Off(empty), Zilch
deftype StateHard = either On(?int), Off(?int)
deftype Contrived[A, B] = either Stuff({ a: A, b: B }), Empty

fn test() {


  // A naming collision
  let State = {};
  State;

  let _: State = State.Zilch;

  enum_construction/State.On({});
  enum_construction/State.Off({});

  let _: enum_construction/State = enum_construction/State.Off({});
  let _: enum_construction/State = enum_construction/State.On({});

  StateHard.On(.Some(42));
  let _: StateHard = StateHard.On(.Some(42));
  let _: StateHard = StateHard.On(.None);

  // A naming collision
  let Opt = {};
  Opt;

  let _: Opt[bool]      = .Some(true);
  let bc = _root/core/Opt.Some[bool](true);
  assert(bc is .Some(true));
  let bc2 = _root/core/Opt.Some(42);
  assert(bc2 is .Some(42));

  let _: Opt[bool] = Opt.None;
  let _: Opt[bool] = .None;
  let _: Opt[bool] = Opt.None;

  let _: Opt[i32] = Opt.None[i32];
  let _: Opt[i32] = Opt.None[i32];
  let _: Opt[i32] = Opt.None;

  Contrived.Stuff({ a: 42, b: "hello"});

  Opt.None[int];

  {}
}
